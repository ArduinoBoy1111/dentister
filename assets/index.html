<!DOCTYPE html>
<html lang="ar" dir="ltr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dentister</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <main style="display: flex;width: 100%;">
        <div class="today-list">
           <div class="card">
                <div style="display: flex;align-items: center;justify-content: center;width: 100%;">
                    <div class="flex-line"></div>
                    <h1 id="current_day_header">غير معروف</h1>
                    <div class="flex-line"></div>
                </div>
                <div style="width: 100%;display: flex;justify-content: center;align-items: center;">
                    <button class="add-button" onclick="showform()">+</button>

                </div>
           </div>
        </div>
        <div class="main-content-area">
            <div style="display: flex;width: 100%;justify-content: space-between;align-items: center;">
                <button style="width: 8%;height: 6%;" onclick="changeMonth(1)"><</button>
                <h1 id="current_month" style="font-size: 4vw;"></h1>
                <button style="width: 8%;height: 6%;" onclick="changeMonth(-1)">></button>
            </div>
            <div class="display" dir="ltr" style="display:flex;flex-wrap:wrap;width:100%;height:fit-content;justify-content: space-evenly;align-items: start;">

            </div>
        </div>
        <div class="sidebar">
            
            <ul>
                <li><button onclick="changeView('index')">الصفحة الرئيسية</button></li>
                <li><button onclick="changeView('patients')">الارسال و اللاستقبال</button></li>
            </ul>

        </div>

        <form action="" hidden class="form" id="form">
            <div class="form-card">
                <div style="width: 100%;">
                    <div style="display: flex;align-items: center;justify-content: center;width: 100%;">
                        <div class="flex-line"></div>
                        <h1 id="current_day_header">اضافة مريض</h1>
                        <div class="flex-line"></div>
                    </div>

                    <div class="form-group">
                        <label for="name">الاسم</label>
                        <input type="text" name="name" id="name" placeholder="ادخل الاسم" required>
                    </div>

                    <div class="form-group">
                        <label for="phone_num">الرقم</label>
                        <input type="text" name="phone_num" id="phone_num" placeholder="ادخل الرقم" required>
                    </div>

                    <div class="form-group">
                        <label  for="info">المعلومات</label>
                        <textarea name="info" id="info" placeholder="ادخل المعلومات" rows="4" ></textarea>
                    </div>
                </div>



                <div class="buttons-area">
                    <button class="ok-button" onclick="submitform()">موافق</button>
                    <button class="cancel-button" onclick="closeform()">إلغاء</button>
                </div>
            </div>
        </form>
    </main>
    
    <script>
        today_header = document.getElementById('current_day_header');

        function changeView(view) {
            window.pywebview.api.navigate(view);
        }
        const now = new Date();

        const monthNames = [
          "كانون الثاني",  // January
          "شباط",        // February
          "آذار",        // March
          "نيسان",       // April
          "أيار",        // May
          "حزيران",      // June
          "تموز",        // July
          "آب",          // August
          "أيلول",       // September
          "تشرين الأول",  // October
          "تشرين الثاني",  // November
          "كانون الأول"   // December
        ];
        let month = now.getMonth() + 1;
        let year = now.getFullYear();
        const daysInMonth = new Date(year, month, 0).getDate();
        document.getElementById('current_month').textContent = " (" + month + ") " + monthNames[now.getMonth()]  + " " + now.getFullYear();
        createCalendar();
        function createCalendar() {
            const daysInMonth = new Date(year, month, 0).getDate();
            document.querySelector('.display').innerHTML = ''; // Clear previous content
            document.getElementById('current_month').textContent = " (" + month + ") " + monthNames[month - 1] + " " + year;
            for (let i = 1; i <= daysInMonth; i++) {
               const daySquare = document.createElement('div');
               const addrtag = document.createElement('button');
               addrtag.onclick = () => {
                   today_header.textContent = "اليوم: " + i + "/" + monthNames[month - 1] + "/" + year;
                   window.pywebview.api.updateDay(i);
               };
               addrtag.style.textDecoration = 'none';
               daySquare.className = 'day-square';
               daySquare.textContent = i;
               addrtag.appendChild(daySquare);
               document.querySelector('.main-content-area .display').appendChild(addrtag);
           }
        }

        function changeMonth(direction) {
            month += direction;
            if (month < 1) {
                month = 12;
                year -= 1;
            } else if (month > 12) {
                month = 1;
                year += 1;
            }
            createCalendar();
        }
        function showform(){
            form = document.getElementById('form');
            form.hidden = false;
            form.style.opacity = 0;
            form.style.transition = '0.15s ease-in-out';
            requestAnimationFrame(() => {
             form.style.opacity = 1;
            });
        }
        function closeform(){
            const form = document.getElementById('form');
            form.style.opacity = 1;
            form.style.transition = 'opacity 0.15s ease-in-out';
            requestAnimationFrame(() => {
                form.style.opacity = 0;
            });

            form.addEventListener('transitionend', function handler() {
                form.hidden = true;
                form.removeEventListener('transitionend', handler);
            });
        }
    </script>
</body>
</html>